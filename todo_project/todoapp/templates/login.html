{% load static %}
<!DOCTYPE html>
<html lang="en">
<head>
  <!-- Design by foolishdeveloper.com -->
    <title>Login Page</title>
    
    {% comment %} <link rel="preconnect" href="https://fonts.gstatic.com">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.3.0/css/all.min.css">
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;500;600&display=swap" rel="stylesheet"> {% endcomment %}
    <link rel="stylesheet" href="{% static 'css/login.css' %}">

    <!--Stylesheet-->
</head>
<body>
    <div class="background">
        <div class="shape"></div>
        <div class="shape"></div>
    </div>
    <form id="login-form" method="post" action="{% url 'login' %}">
        <h3>Login Here</h3>
        {% csrf_token %} 
        <label for="username">Username</label>
        <input type="text" placeholder="Enter Username" name="username" id="username">

        <label for="password">Password</label>
        <input type="password" placeholder="Password" name="password" id="password">

        <button type="button" id="btn1">Log In</button>
        <br>
        <br>
        <a href="{% url 'signup' %}">Create an account</a>
    </form>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.7.0/jquery.min.js" 
    integrity="sha512-3gJwYpMe3QewGELv8k/BX9vcqhryRdzRMxVfq6ngyWXwo03GFEzjsUm8Q7RZcHPHksttq7/GFoxjCVUjkjvPdw==" 
    crossorigin="anonymous" referrerpolicy="no-referrer"></script>
    
    <script>
        $(document).ready(function() {
            $('#btn1').click(function(e) {
                e.preventDefault();
                var username = $('#username').val();
                var password = $('#password').val();
                var data = {
                    'csrfmiddlewaretoken': $('input[name=csrfmiddlewaretoken]').val(),
                    'username': username,
                    'password': password
                };

                if (username === '') {
                    alert('Please enter a valid username');
                } else if (password === '') {
                    alert('Please enter a valid password');
                } else {
                    $.ajax({
                        url: $('#login-form').attr('action'),
                        method: 'POST',
                        data: data,
                        dataType: 'json',
                        success: function(data) {
                            if (data.success) {
                                alert('Welcome');
                                window.location.replace('/index');
                            } else {
                                alert('Sorry, try again');
                            }
                        },
                        error: function(xhr, textStatus, error) {
                            console.log(xhr.responseText);
                        }
                    });
                }
            });
        });
    </script>
</body>
</html>
